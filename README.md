# 玉山人工智慧公開挑戰賽#1 - 金融商品交易預測
> 競賽連結： https://tbrain.trendmicro.com.tw/Competitions/Details/5
> 下方資料取自官網
> ## 競賽說明
> 對於每間企業而言，顧客的喜好及購買行為一直都是企業關注的議題。而投放的行銷是否有效益，顧客會不會以購買表示支持，也是企業經營的重要生存關鍵。在科技化的時代，人們習慣用網路瀏覽來探索商品，因此每間企業都努力的在網站上吸引顧客的眼球，期待顧客的買單，但顧客究竟會不會買單，傳統上我們只能事後得知。因此我們就在想，有沒有辦法透過模型進而預測顧客的購買行為呢？本次比賽提供顧客在玉山官網上120天的瀏覽行為、基本屬性及交易/申請的去識別化行為資料，希望結合群眾智慧，預測顧客在之後的30天與玉山有哪些金融商品的往來。

> ## 預測商品說明
> #### •	信用卡(CC)：預測顧客是否申辦信用卡，不論後續是否核卡成功
> #### •	信託類產品(WM)：預測顧客是否以單筆/定期定額的方式，進行信託類產品(包括基金、債券、股票、ETF…)的申購/轉換
> #### 【註：申購定期定額基金只會顯示最早申購及轉換的時點，若後面月份只是持續扣款則不會出現在TBN_WM_TXN資料表當中】
> #### •	信貸(LN)：預測顧客是否進件，不論後續是否申貸成功
> #### •	外匯(FX)：預測顧客是否以台幣購買外幣

> ## 評分方式
> 每種金融產品對於銀行有不同的價值，在計算得分時會參考不同產品對於銀行的價值給予得分上的加權．
> 評分的計算方式為: 
> 產品權重:外匯=1, 信用卡=10, 信託類產品=20, 信貸=20
> (產品權重)*各產品預測結果的 f1_score 總和
> Score = FX_f1*1 + CC_f1*10 + WM_f1*20 + LN_f1*20
> 將各產品權重乘以各產品預測結果的f1_score後，計算出得分。得分越高排名越前面。
> 舉例:
> 您參考某人瀏覽官網行為及該人背景資訊後，預測他在四個產品線未來交易與否。評分函式根據您預測出的結果，與真實答案比對後，發現您預測出的信用卡交易(CC) f1_score為0.3，信貸交易(LN) f1_score為0.12，信託類產品交易(WM) f1_score為0.01，外匯交易(FX) f1_score為0.43。因此您的總得分為:
1*0.43 + 10*0.3 + 20*0.01 + 20*0.12 = 6.03
> 註: 交易為1代表有購買，0代表沒有購買

> ## 資料集
> 1. 訓練資料集時間為 9447+1 (9448) ~ 9447+120 (9567) 之間，共120日之間產品交易/申請資訊．
> 2.	本次比賽是請參賽者預測在9447+121 (9568) ~ 9447+150 (9597) 時間區間內（共30日），顧客在四個產品線CC_IND, FX_IND, LN_IND, WM_IND是否會進行交易，若預測顧客該時間內於任一產品線交易一次以上，該產品線的預測值為1，否則為0．例如: 顧客序號12345，預測信用卡核卡1次，外匯交易2次，沒有信貸申請，信託交易3次，該筆預測資料應為: 12345,1,1,0,1 ．
> 3.	TBN_Y_ZERO.csv則是提供給參賽者做為上傳範例資料檔使用，內部預設值是全部為0．

<table border="1"><tbody><tr><td bgcolor="yellow"><p>資料表名稱</p></td><td bgcolor="yellow"><p>筆數</p></td><td bgcolor="yellow"><p>欄位</p></td><td bgcolor="yellow"><p>說明</p></td></tr><tr><td rowspan="3"><p>TBN_CUST_BEHAVIOR</p><p>(顧客網頁瀏覽行為)</p></td><td rowspan="3">2,209,864筆</td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>VISITDATE</p></td><td><p>瀏覽日期</p></td></tr><tr><td><p>PAGE</p></td><td><p>瀏覽網址(經過特殊處理)</p></td></tr><tr><td rowspan="8"><p>TBN_CIF</p><p>(顧客基本屬性資料，僅</p><p>提供顧客目前最新狀態)</p></td><td rowspan="8"><p>187,679筆</p></td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>AGE</p></td><td><p>年齡</p><p>(年齡會分成四個級距)</p></td></tr><tr><td><p>CHILDREN_CNT</p></td><td><p>子女數</p></td></tr><tr><td><p>CUST_START_DT</p></td><td><p>顧客與本行最早往來日</p></td></tr><tr><td><p>EDU_CODE</p></td><td><p>教育程度代碼</p><p>(如:大學、碩士)</p></td></tr><tr><td><p>GENDER_CODE</p></td><td><p>性別代碼</p></td></tr><tr><td><p>INCOME_RANGE_CODE</p></td><td><p>年收入級距代碼</p></td></tr><tr><td><p>WORK_MTHS</p></td><td><p>工作月數</p><p>(工作月數會分成5個級距)</p></td></tr><tr><td rowspan="2"><p>TBN_CC_APPLY</p><p>(顧客信用卡核卡資料)</p></td><td rowspan="2"><p>54,393筆</p></td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>TXN_DT</p></td><td><p>申請信用卡日期</p></td></tr><tr><td rowspan="3"><p>TBN_FX_TXN</p><p>(顧客外匯交易資料)</p></td><td rowspan="3"><p>507,185筆</p></td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>TXN_DT</p></td><td><p>交易日期</p></td></tr><tr><td><p>FX_TXN_AMT</p></td><td><p>交易金額</p></td></tr><tr><td rowspan="4"><p>TBN_LN_APPLY</p><p>(顧客信貸申請資料)</p></td><td rowspan="4"><p>6,741筆</p></td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>TXN_DT</p></td><td><p>申貸日期</p></td></tr><tr><td><p>LN_AMT</p></td><td><p>申貸金額</p></td></tr><tr><td><p>LN_USE</p></td><td><p>申貸用途代碼</p><p>(如:結婚、公司周轉金)</p></td></tr><tr><td rowspan="5"><p>TBN_WM_TXN</p><p>(顧客信託類產品交易資料)</p></td><td rowspan="5"><p>36,763筆</p></td><td><p>CUST_NO</p></td><td><p>顧客代碼</p></td></tr><tr><td><p>TXN_DT</p></td><td><p>交易日期</p></td></tr><tr><td><p>CUST_RISK_CODE</p></td><td><p>顧客風險屬性</p><p>(顧客能夠承受的風險程度，</p><p>數值大小與程度無關)</p></td></tr><tr><td><p>INVEST_TYPE_CODE</p></td><td><p>信託性質</p><p>(如:單筆交易、定期定額)</p></td></tr><tr><td><p>WM_TXN_AMT</p></td><td><p>交易金額</p></td></tr><tr><td rowspan="5"><p>TBN_RECENT_DT</p><p>(顧客最近一次交易時間)</p><p>此檔保留顧客於9448前</p><p>的最後交易日，此資訊</p><p>可用上述資料集更新</p></td><td rowspan="5"><p>195,000筆</p></td><td><p><span style="letter-spacing:0.48px;">CUST_NO</span></p></td><td><p><span style="letter-spacing:0.48px;">顧客代碼</span></p></td></tr><tr><td><p><span style="letter-spacing:0.48px;">CC_RECENT_DT</span></p></td><td><p><span style="letter-spacing:0.48px;">最近一次申請信用卡時間</span></p></td></tr><tr><td><p>LN_RECENT_DT</p></td><td><p>最近一次申貸時間</p></td></tr><tr><td><p>WM_RECENT_DT</p></td><td><p>最近一次信託類產品交易時間</p></td></tr><tr><td><p>FX_RECENT_DT</p></td><td><p>最近一次外匯交易時間</p></td></tr><tr><td colspan="4" width="624"><p>註1: CUST_START_DT、TXN_DT、CC_RECENT_DT、LN_RECENT_DT、WM_RECENT_DT、FX_RECENT_DT日期有經過重新編碼，該數字仍具備日期的順序性與相對性，如: 假設起始日為2019.1.1編碼為1，2019.1.31則編碼為31。本次資料集起始時間為9448．</p></td></tr></tbody></table>

# 分析流程
### 資料認識 → 資料預先處理 → 資料清理 → 類神經網路模型 → 驗證模型 → 不斷調整細節&流程

# 資料預測邏輯
### 1. 原本想法 - 前 120 天數據 預測 121~150天的數據
> 作法：依照前120 天使用者數據分析、建立模型→預測121~150天客戶購買行為
>
> 議題：
> 
> (1) 121~150 天 並無使用者 "行為層面" 相關數據 (僅有ID 連結到基本資料)
>
> (2) 若僅分析消費者基本資料 跑 機器學習 → 恐資料參考性不足
>
> (3) 無法明確定義 分析的前提假設


### 2. 30 天週期預測法
> 作法：將1-120天資料群分類 (1-30天、31-60天、61-90天、91-120天)
> ####(前提假設： 消費者前30天之相關行為，將會影響後30天相關金融產品購買行為)
> 
> 訓練資料集(一)： 1-30天 所有使用者資訊(基本資料、網頁瀏覽資料、購買資料) 
                + Target Data (31-60天；是否購買四項金融產品)
> 訓練資料集(二)： 31-60天 所有使用者資訊(基本資料、網頁瀏覽資料、購買資料) 
                + Target Data (61-90天；是否購買四項金融產品)
> 訓練資料集(三)： 61-90天 所有使用者資訊(基本資料、網頁瀏覽資料、購買資料) 
                + Target Data (91-120天；是否購買四項金融產品)
> 測試資料集(一)： 91-120天 所有使用者資訊(基本資料、網頁瀏覽資料、購買資料) 
                + Target Data (121-150天；是否購買四項金融產品) → 競賽目標

## 競賽成果
#### 435名 / 1121支參賽隊伍 (40%)
#### 最後的模型結果，以 貸款申請 (LN) & 信託產品 (WM) 的模型表現較好，測試集的正確率分別為 98%, 78%
#### 而 信用卡申辦 (CC) & 外匯產品 (FX) 的模型表現較不盡理想 (準確率分別為： 44%, 21%，
#### 因時間不足，因此競賽成績較不理想，但模型仍有取多改善空間，例如 增加 hidden layers, resampling 可更加細化, 甚至是前置數據的處理, 整體訓練資料的準備等。
#### 歡迎大家提出任何意見、看法，一同交流學習！¶
